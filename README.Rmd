---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# BREAD

<!-- badges: start -->
[![R-CMD-check](https://github.com/jonotuke/BREAD/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/jonotuke/BREAD/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

The goal of BREAD is to provide an easy-to-use method for estimating degrees of relatedness (up to the second degree) for extremely low-coverage data. BREAD also allows users to quantify and visualise the level of confidence in the estimated degrees of relatedness.

## Installation

You can install the development version of BREAD from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("jonotuke/BREAD")
```

## Example

This basic example shows you how to analyse a real (anonymised) ancient DNA data set. 

First we load a raw counts example. 

```{r example}
library(BREAD)
counts_example
```

We can we can estimate the degrees of relatedness from the raw counts using

```{r}
relatedness_example <- callRelatedness(counts_example)
relatedness_example
```

An overall picture of the relatedness for these individuals can be created using

```{r, warning=FALSE, message=FALSE}
plotLOAF(relatedness_example)
```

A diagnostic plot for the assignment of the "Unrelated" degree of relatedness to individuals Ind1 and Ind2 can be produced using

```{r}
plotSLICE(relatedness_example, row = 1)
```

Alternatively we can call

```{r}
plotSLICE(relatedness_example, row = "Ind1 - Ind2")
```

We can test whether the observed PMR between Ind1 and Ind2 is consistent with a 3rd-degree genetic relationship,or not, using

```{r}
test_degree(relatedness_example, 1, 3)
```


